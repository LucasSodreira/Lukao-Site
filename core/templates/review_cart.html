{% extends 'base.html' %}
{% load static %}
{% block main %}
<link rel="stylesheet" href="{% static 'css/review_cart.css' %}" />
<link rel="stylesheet" href="{% static 'css/carrinho.css' %}" />

<div class="container">
  <div class="left-content">

    <!-- Endereço de Entrega -->
    <div class="endereco-entrega">
      <h2>Endereço de Entrega</h2>

      {% if tem_endereco %}
        <div class="center-infos">
          <div class="endereco-info">
            <p><strong>Nome:</strong> {{ endereco.nome_completo }}</p>
            <p><strong>Telefone:</strong> {{ endereco.telefone }}</p>
            <p><strong>Rua:</strong> {{ endereco.rua }}, {{ endereco.numero }}</p>
            {% if endereco.complemento %}
              <p><strong>Complemento:</strong> {{ endereco.complemento }}</p>
            {% endif %}
            <p><strong>CEP:</strong> {{ endereco.cep }}</p>
            <p><strong>Cidade/Estado:</strong> {{ endereco.cidade }}/{{ endereco.estado }}</p>
            <p><strong>País:</strong> {{ endereco.pais }}</p>
          </div>
          <a href="{% url 'endereco' %}" class="btn-alterar">Alterar Endereço</a>
        </div>
      {% else %}
        <div class="sem-endereco">
          <p>Você ainda não cadastrou um endereço de entrega.</p>
          <a href="{% url 'endereco' %}" class="btn-adicionar">Adicionar Endereço</a>
        </div>
      {% endif %}
    </div>

    <!-- Produtos do Carrinho -->
    <div class="cart-page">
      {% for item in produtos_carrinho %}
        <div class="cart-item">
          <div class="item-image">
            {% if item.produto.imagem %}
              <img src="{{ item.produto.imagem.url }}" alt="{{ item.produto.nome }}">
            {% else %}
              <img src="{% static 'images/image(1).png' %}" alt="Imagem Padrão">
            {% endif %}
          </div>

          <div class="item-details">
            <h2>{{ item.produto.nome }}</h2>
            <p class="description">{{ item.produto.descricao|truncatewords:20 }}</p>

            <div class="price-quantity">
              <span class="price">R$ {{ item.produto.preco }} × {{ item.quantidade }}</span>
              <span class="subtotal">Subtotal: R$ {{ item.subtotal }}</span>
            </div>
          </div>
        </div>
        <hr id="divider">
      {% empty %}
        <p>Seu carrinho está vazio.</p>
      {% endfor %}
    </div>

  </div>

  <!-- RESUMO DO PEDIDO -->
  <aside class="order-summary">
    <h3>Resumo do Pedido</h3>

    <div class="summary-item">
      <span>Itens:</span>
      <span>R$ {{ total_carrinho }}</span>
    </div>

    <div class="summary-total">
      <span>Total:</span>
      <span class="total-price">R$ {{ total_carrinho }}</span>
    </div>

    <form method="post">
      {% csrf_token %}
      <button type="submit" class="place-order">Finalizar Pedido</button>
    </form>
  </aside>

</div>
{% endblock %}
